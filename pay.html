<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title> new document </title>
  <meta name="generator" content="editplus" />
  <meta name="author" content="" />
  <meta name="keywords" content="" />
  <meta name="description" content="" />
	<script type="text/javascript">
	<!--
		//调用微信登录获取 code
    wx.login({
      success: function(res){
        var code = res.code;
        // 发送 res.code 到后台换取 openId, sessionKey, unionId
        if (code) {
          //发起网络请求
          //微信支付金额
          var order_amount = that.data.total - that.data.youhuiPrice
          //随机生成的商户订单号
          var order_sn = that.getOrderSn();
          sendData.order_sn = order_sn;
          wx.request({
            url: 'https://www.yuanboqihang.cn/zmDecoration/mansc/public/pay.php',
            data: {
              code: code,
              "goods_name": "贺大妈贺福记-餐饮",//商店名
              "order_sn": order_sn,//订单号
              "order_amount": order_amount //微信支付总金额
            },
            method: 'POST',
            header: {
              'content-type': 'application/x-www-form-urlencoded'
            },
            success: function (response) {
              // 发起支付
              wx.requestPayment({
                'timeStamp': response.data.timeStamp,
                'nonceStr': response.data.nonceStr,
                'package': response.data.package,
                'signType': 'MD5',
                'paySign': response.data.paySign,
                'success': function (res) {
                  if (res.errMsg == 'requestPayment:ok') {
	//-->
	</script>
 </head>
		
 <body>
  
 </body>
</html>
